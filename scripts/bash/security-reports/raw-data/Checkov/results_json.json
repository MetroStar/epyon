{"check_type": "kubernetes", "results": {"failed_checks": [{"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[23, "apiVersion: v1\n"], [24, "kind: ServiceAccount\n"], [25, "metadata:\n"], [26, "  name: advana-marketplace\n"], [27, "  labels:\n"], [28, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [29, "    app.kubernetes.io/name: advana-marketplace\n"], [30, "    app.kubernetes.io/instance: advana-marketplace\n"], [31, "    app.kubernetes.io/version: \"1.0.4\"\n"], [32, "    app.kubernetes.io/managed-by: Helm\n"], [33, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [23, 33], "resource": "ServiceAccount.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[36, "apiVersion: v1\n"], [37, "kind: Secret\n"], [38, "metadata:\n"], [39, "  name: advana-marketplace-env\n"], [40, "  labels:\n"], [41, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [42, "    app.kubernetes.io/name: advana-marketplace\n"], [43, "    app.kubernetes.io/instance: advana-marketplace\n"], [44, "    app.kubernetes.io/version: \"1.0.4\"\n"], [45, "    app.kubernetes.io/managed-by: Helm\n"], [46, "type: Opaque\n"], [47, "data:\n"], [48, "  SECRET_KEY: Y2hhbmdlbWU=\n"], [49, "# Stub volume secret template\n"], [50, "apiVersion: v1\n"], [51, "kind: Secret\n"], [52, "metadata:\n"], [53, "  name: advana-marketplace-volume\n"], [54, "  labels:\n"], [55, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [56, "    app.kubernetes.io/name: advana-marketplace\n"], [57, "    app.kubernetes.io/instance: advana-marketplace\n"], [58, "    app.kubernetes.io/version: \"1.0.4\"\n"], [59, "    app.kubernetes.io/managed-by: Helm\n"], [60, "type: Opaque\n"], [61, "data:\n"], [62, "  secret.yaml: c2VjcmV0ZGF0YQ==\n"], [63, "# Stub TLS secret template\n"], [64, "apiVersion: v1\n"], [65, "kind: Secret\n"], [66, "metadata:\n"], [67, "  name: advana-marketplace-tls\n"], [68, "  labels:\n"], [69, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [70, "    app.kubernetes.io/name: advana-marketplace\n"], [71, "    app.kubernetes.io/instance: advana-marketplace\n"], [72, "    app.kubernetes.io/version: \"1.0.4\"\n"], [73, "    app.kubernetes.io/managed-by: Helm\n"], [74, "type: kubernetes.io/tls\n"], [75, "data:\n"], [76, "  tls.crt: TFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0\n"], [77, "  tls.key: TFMwdExTMUNSVWRKVGlCUVVrbFdRVlJGSUV0RldTMHRMUzB0\n"], [78, "# Stub docker config secret template\n"], [79, "apiVersion: v1\n"], [80, "kind: Secret\n"], [81, "metadata:\n"], [82, "  name: advana-marketplace-docker\n"], [83, "  labels:\n"], [84, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [85, "    app.kubernetes.io/name: advana-marketplace\n"], [86, "    app.kubernetes.io/instance: advana-marketplace\n"], [87, "    app.kubernetes.io/version: \"1.0.4\"\n"], [88, "    app.kubernetes.io/managed-by: Helm\n"], [89, "type: kubernetes.io/dockerconfigjson\n"], [90, "data:\n"], [91, "  .dockerconfigjson: e30=\n"], [92, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [36, 92], "resource": "Secret.default.advana-marketplace-docker", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[95, "apiVersion: v1\n"], [96, "kind: ConfigMap\n"], [97, "metadata:\n"], [98, "  name: advana-marketplace-env\n"], [99, "  labels:\n"], [100, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [101, "    app.kubernetes.io/name: advana-marketplace\n"], [102, "    app.kubernetes.io/instance: advana-marketplace\n"], [103, "    app.kubernetes.io/version: \"1.0.4\"\n"], [104, "    app.kubernetes.io/managed-by: Helm\n"], [105, "data:\n"], [106, "  APP_NAME: advana-marketplace\n"], [107, "  APP_VERSION: 1.0.4\n"], [108, "# Stub volume configmap template\n"], [109, "apiVersion: v1\n"], [110, "kind: ConfigMap\n"], [111, "metadata:\n"], [112, "  name: advana-marketplace-volume\n"], [113, "  labels:\n"], [114, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [115, "    app.kubernetes.io/name: advana-marketplace\n"], [116, "    app.kubernetes.io/instance: advana-marketplace\n"], [117, "    app.kubernetes.io/version: \"1.0.4\"\n"], [118, "    app.kubernetes.io/managed-by: Helm\n"], [119, "data:\n"], [120, "  config.yaml: |\n"], [121, "    application:\n"], [122, "      name: advana-marketplace\n"], [123, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [95, 123], "resource": "ConfigMap.default.advana-marketplace-volume", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[145, "apiVersion: v1\n"], [146, "kind: Service\n"], [147, "metadata:\n"], [148, "  name: advana-marketplace\n"], [149, "  labels:\n"], [150, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [151, "    app.kubernetes.io/name: advana-marketplace\n"], [152, "    app.kubernetes.io/instance: advana-marketplace\n"], [153, "    app.kubernetes.io/version: \"1.0.4\"\n"], [154, "    app.kubernetes.io/managed-by: Helm\n"], [155, "spec:\n"], [156, "  type: ClusterIP\n"], [157, "  ports:\n"], [158, "    - port: 80\n"], [159, "      targetPort: 80\n"], [160, "      protocol: TCP\n"], [161, "      name: http\n"], [162, "  selector:\n"], [163, "    app.kubernetes.io/name: advana-marketplace\n"], [164, "    app.kubernetes.io/instance: advana-marketplace\n"], [165, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [145, 165], "resource": "Service.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_43", "bc_check_id": "BC_K8S_39", "check_name": "Image should use digest", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/image"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ImageDigest", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-39", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_22", "bc_check_id": "BC_K8S_21", "check_name": "Use read-only filesystem for containers where possible", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/readOnlyRootFilesystem"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ReadOnlyFilesystem", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-21", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_28", "bc_check_id": "BC_K8S_27", "check_name": "Minimize the admission of containers with the NET_RAW capability", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/capabilities/drop"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DropCapabilities", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-27", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_30", "bc_check_id": "BC_K8S_28", "check_name": "Apply security context to your containers", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ContainerSecurityContext", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-28", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_9", "bc_check_id": "BC_K8S_8", "check_name": "Readiness Probe Should be Configured", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/readinessProbe"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ReadinessProbe", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-8", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_11", "bc_check_id": "BC_K8S_10", "check_name": "CPU limits should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/limits/cpu"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.CPULimits", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-10", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_20", "bc_check_id": "BC_K8S_19", "check_name": "Containers should not run with allowPrivilegeEscalation", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/allowPrivilegeEscalation"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.AllowPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-19", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_29", "bc_check_id": "BC_K8S_43", "check_name": "Apply security context to your pods and containers", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.PodSecurityContext", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/ensure-securitycontext-is-applied-to-pods-and-containers", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_14", "bc_check_id": "BC_K8S_13", "check_name": "Image Tag should be fixed - not latest or blank", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/image"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ImageTagFixed", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-13", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_31", "bc_check_id": "BC_K8S_29", "check_name": "Ensure that the seccomp profile is set to docker/default or runtime/default", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.Seccomp", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-29", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_13", "bc_check_id": "BC_K8S_12", "check_name": "Memory limits should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/limits/memory"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.MemoryLimits", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-12", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_38", "bc_check_id": "BC_K8S_35", "check_name": "Ensure that Service Account Tokens are only mounted where necessary", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ServiceAccountTokens", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-35", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_40", "bc_check_id": "BC_K8S_37", "check_name": "Containers should run as a high UID to avoid host conflict", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.RootContainersHighUID", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-37", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_10", "bc_check_id": "BC_K8S_9", "check_name": "CPU requests should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/requests/cpu"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.CPURequests", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-9", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_12", "bc_check_id": "BC_K8S_11", "check_name": "Memory requests should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/requests/memory"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.MemoryRequests", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-11", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_8", "bc_check_id": "BC_K8S_7", "check_name": "Liveness Probe Should be Configured", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/livenessProbe"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.LivenessProbe", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-7", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_23", "bc_check_id": "BC_K8S_22", "check_name": "Minimize the admission of root containers", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.RootContainers", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-22", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_37", "bc_check_id": "BC_K8S_34", "check_name": "Minimize the admission of containers with capabilities assigned", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/capabilities/drop"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Deployment.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.MinimizeCapabilities", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-34", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_43", "bc_check_id": "BC_K8S_39", "check_name": "Image should use digest", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/image"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ImageDigest", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-39", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_22", "bc_check_id": "BC_K8S_21", "check_name": "Use read-only filesystem for containers where possible", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/readOnlyRootFilesystem"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ReadOnlyFilesystem", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-21", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_28", "bc_check_id": "BC_K8S_27", "check_name": "Minimize the admission of containers with the NET_RAW capability", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/capabilities/drop"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DropCapabilities", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-27", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_30", "bc_check_id": "BC_K8S_28", "check_name": "Apply security context to your containers", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ContainerSecurityContext", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-28", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_11", "bc_check_id": "BC_K8S_10", "check_name": "CPU limits should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/limits/cpu"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.CPULimits", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-10", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_20", "bc_check_id": "BC_K8S_19", "check_name": "Containers should not run with allowPrivilegeEscalation", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/allowPrivilegeEscalation"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.AllowPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-19", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_29", "bc_check_id": "BC_K8S_43", "check_name": "Apply security context to your pods and containers", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.PodSecurityContext", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/ensure-securitycontext-is-applied-to-pods-and-containers", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_14", "bc_check_id": "BC_K8S_13", "check_name": "Image Tag should be fixed - not latest or blank", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/image"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ImageTagFixed", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-13", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_31", "bc_check_id": "BC_K8S_29", "check_name": "Ensure that the seccomp profile is set to docker/default or runtime/default", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.Seccomp", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-29", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_13", "bc_check_id": "BC_K8S_12", "check_name": "Memory limits should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/limits/memory"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.MemoryLimits", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-12", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_38", "bc_check_id": "BC_K8S_35", "check_name": "Ensure that Service Account Tokens are only mounted where necessary", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.ServiceAccountTokens", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-35", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_40", "bc_check_id": "BC_K8S_37", "check_name": "Containers should run as a high UID to avoid host conflict", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.RootContainersHighUID", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-37", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_10", "bc_check_id": "BC_K8S_9", "check_name": "CPU requests should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/requests/cpu"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.CPURequests", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-9", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_12", "bc_check_id": "BC_K8S_11", "check_name": "Memory requests should be set", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/resources/requests/memory"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.MemoryRequests", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-11", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_23", "bc_check_id": "BC_K8S_22", "check_name": "Minimize the admission of root containers", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.RootContainers", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-22", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_37", "bc_check_id": "BC_K8S_34", "check_name": "Minimize the admission of containers with capabilities assigned", "check_result": {"result": "FAILED", "evaluated_keys": ["spec/template/spec/containers/[0]/securityContext/capabilities/drop"]}, "code_block": [[218, "apiVersion: batch/v1\n"], [219, "kind: Job\n"], [220, "metadata:\n"], [221, "  name: advana-marketplace\n"], [222, "  labels:\n"], [223, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [224, "    app.kubernetes.io/name: advana-marketplace\n"], [225, "    app.kubernetes.io/instance: advana-marketplace\n"], [226, "    app.kubernetes.io/version: \"1.0.4\"\n"], [227, "    app.kubernetes.io/managed-by: Helm\n"], [228, "spec:\n"], [229, "  template:\n"], [230, "    spec:\n"], [231, "      restartPolicy: Never\n"], [232, "      containers:\n"], [233, "      - name: job\n"], [234, "        image: \"busybox:latest\"\n"], [235, "        command: [\"echo\", \"Job completed\"]\n"], [236, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [218, 236], "resource": "Job.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.MinimizeCapabilities", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-34", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_K8S_21", "bc_check_id": "BC_K8S_20", "check_name": "The default namespace should not be used", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[239, "apiVersion: networking.k8s.io/v1\n"], [240, "kind: Ingress\n"], [241, "metadata:\n"], [242, "  name: advana-marketplace\n"], [243, "  labels:\n"], [244, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [245, "    app.kubernetes.io/name: advana-marketplace\n"], [246, "    app.kubernetes.io/instance: advana-marketplace\n"], [247, "    app.kubernetes.io/version: \"1.0.4\"\n"], [248, "    app.kubernetes.io/managed-by: Helm\n"], [249, "spec:\n"], [250, "  rules:\n"], [251, "  - host: example.com\n"], [252, "    http:\n"], [253, "      paths:\n"], [254, "      - path: /\n"], [255, "        pathType: Prefix\n"], [256, "        backend:\n"], [257, "          service:\n"], [258, "            name: advana-marketplace\n"], [259, "            port:\n"], [260, "              number: 80\n"], [261, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [239, 261], "resource": "Ingress.default.advana-marketplace", "evaluations": {}, "check_class": "checkov.kubernetes.checks.resource.k8s.DefaultNamespace", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/kubernetes-policies/kubernetes-policy-index/bc-k8s-20", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV2_K8S_6", "bc_check_id": null, "check_name": "Minimize the admission of pods which lack an associated NetworkPolicy", "check_result": {"result": "FAILED", "evaluated_keys": ["resource_type"]}, "code_block": [[168, "apiVersion: apps/v1\n"], [169, "kind: Deployment\n"], [170, "metadata:\n"], [171, "  name: advana-marketplace\n"], [172, "  labels:\n"], [173, "    helm.sh/chart: advana-marketplace-1.0.4\n"], [174, "    app.kubernetes.io/name: advana-marketplace\n"], [175, "    app.kubernetes.io/instance: advana-marketplace\n"], [176, "    app.kubernetes.io/version: \"1.0.4\"\n"], [177, "    app.kubernetes.io/managed-by: Helm\n"], [178, "spec:\n"], [179, "  replicas: 1\n"], [180, "  selector:\n"], [181, "    matchLabels:\n"], [182, "      app.kubernetes.io/name: advana-marketplace\n"], [183, "      app.kubernetes.io/instance: advana-marketplace\n"], [184, "  template:\n"], [185, "    metadata:\n"], [186, "      labels:\n"], [187, "        app.kubernetes.io/name: advana-marketplace\n"], [188, "        app.kubernetes.io/instance: advana-marketplace\n"], [189, "    spec:\n"], [190, "      containers:\n"], [191, "      - name: advana-marketplace\n"], [192, "        image: \"nginx:latest\"\n"], [193, "        ports:\n"], [194, "        - containerPort: 80\n"], [195, "---\n"]], "file_path": "/security-reports/raw-data/Helm/rendered-templates.yaml", "file_abs_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "repo_file_path": "/repo/security-reports/raw-data/Helm/rendered-templates.yaml", "file_line_range": [168, 195], "resource": "Pod.default.advana-marketplace.app.kubernetes.io/name-advana-marketplace.app.kubernetes.io/instance-advana-marketplace", "evaluations": {}, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}]}, "summary": {"passed": 142, "failed": 42, "skipped": 0, "parsing_errors": 0, "resource_count": 16, "checkov_version": "3.2.493"}}